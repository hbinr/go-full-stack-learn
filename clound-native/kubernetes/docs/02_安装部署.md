# k8så®‰è£…éƒ¨ç½²
- Minikubeï¼šk8sæœ¬åœ°å®‰è£…ä¾¿æ·ï¼Œæ˜“ä¸Šæ‰‹

## Minikube å®‰è£…
[Minikube](https://minikube.sigs.k8s.io/docs/) æ˜¯ä¸€ä¸ªæ˜“äºåœ¨æœ¬åœ°è¿è¡Œ Kubernetes çš„å·¥å…·ï¼Œå¯åœ¨ä½ çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šçš„è™šæ‹Ÿæœºå†…è½»æ¾åˆ›å»ºå•æœºç‰ˆ Kubernetes é›†ç¾¤ã€‚ä¾¿äºå°è¯• Kubernetes æˆ–ä½¿ç”¨ Kubernetes æ—¥å¸¸å¼€å‘ã€‚åˆå­¦è€…æ¨èä½¿ç”¨è¿™ç§æ–¹å¼
### Linuxä¸‹å®‰è£…

1. æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š

```sh
curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64 && chmod +x minikube && sudo mv minikube /usr/local/bin/
```

1. ä½¿ç”¨è¯¥å‘½ä»¤å¯ä»¥å¿«é€Ÿå¯åŠ¨k8sé›†ç¾¤ï¼š

```sh
minikube start --driver=docker --image-mirror-country='cn' \
--registry-mirror=https://guuu392p.mirror.aliyuncs.com \
--iso-url=https://kubernetes.oss-cn-hangzhou.aliyuncs.com/minikube/iso/minikube-v1.6.0.iso
```
- `--driver=docker` è¡¨ç¤ºä½¿ç”¨dockerå®¹å™¨è¿è¡Œï¼Œå¦‚æœä½¿ç”¨dockerè¿è¡Œï¼Œé‚£ä¹ˆä¸è¦åœ¨rootç”¨æˆ·ä¸‹æ‰§è¡Œä¸Šè¿°å‘½ä»¤ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼š
  - >  Exiting due to DRV_AS_ROOT: The â€œdockerâ€œ driver should not be used with root privileges
- `--image-mirror-country cn` è¡¨ç¤ºå°†ç¼ºçœåˆ©ç”¨ registry.cn-hangzhou.aliyuncs.com/google_containers ä½œä¸ºå®‰è£…Kubernetesçš„å®¹å™¨é•œåƒä»“åº“ ï¼ˆé˜¿é‡Œäº‘ç‰ˆæœ¬å¯é€‰ï¼‰
- `--iso-url=***` åˆ©ç”¨é˜¿é‡Œäº‘çš„é•œåƒåœ°å€ä¸‹è½½ç›¸åº”çš„ .iso æ–‡ä»¶ ï¼ˆé˜¿é‡Œäº‘ç‰ˆæœ¬å¯é€‰ï¼‰
- `--cpus=4`: ä¸ºminikubeè™šæ‹Ÿæœºåˆ†é…CPUæ ¸æ•°
- `--memory=4096mb`: ä¸ºminikubeè™šæ‹Ÿæœºåˆ†é…å†…å­˜æ•°

ä½†æ˜¯é‡åˆ°äº†é—®é¢˜ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š
```sh
ğŸ˜„  Debian 10.6 ä¸Šçš„ minikube v1.15.1
âœ¨  æ ¹æ®ç”¨æˆ·é…ç½®ä½¿ç”¨ none é©±åŠ¨ç¨‹åº

âŒ  Exiting due to GUEST_MISSING_CONNTRACK: Sorry, Kubernetes 1.19.4 requires conntrack to be installed in root's path
```

**å®‰è£… `conntrack`å³å¯è§£å†³ï¼š**
 [å‚è€ƒ minikube/issues/7179](https://github.com/kubernetes/minikube/issues/7179)
```sh
sudo apt-get install conntrack
```

ç„¶åå†é‡æ–°æ‰§è¡Œå¯åŠ¨å‘½ä»¤

1. æŸ¥çœ‹å¯åŠ¨æ˜¯å¦æˆåŠŸ

```sh
minikube status
```

æˆåŠŸåˆ™æ˜¾ç¤ºä»¥ä¸‹ç»“æœï¼š
```sh

```



ä½†æ˜¯ç®¡ç†é›†ç¾¤è¿˜éœ€è¦ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…· `kubectl`

## kubectl å‘½ä»¤è¡Œå·¥å…·å®‰è£…

### æ–¹å¼ä¸€ï¼š Ubuntuã€Debian æˆ– HypriotOSç³»ç»Ÿä½¿ç”¨åŸç”ŸåŒ…ç®¡ç†å™¨å®‰è£…

```sh
sudo apt-get update && sudo apt-get install -y apt-transport-https gnupg2 curl
curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
echo "deb https://apt.kubernetes.io/ kubernetes-xenial main" | sudo tee -a /etc/apt/sources.list.d/kubernetes.list
sudo apt-get update
sudo apt-get install -y kubectl
```
æ¨èä½¿ç”¨è¿™ç§æ–¹å¼å®‰è£…

### æ–¹å¼äºŒï¼šä½¿ç”¨ curl å®‰è£… kubectl
1. ä½¿ç”¨ä¸‹é¢å‘½ä»¤ä¸‹è½½æœ€æ–°çš„å‘è¡Œç‰ˆæœ¬ï¼š
```sh
curl -LO "https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl"
```
è¦ä¸‹è½½ç‰¹å®šç‰ˆæœ¬ï¼Œ `$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)` éƒ¨åˆ†æ›¿æ¢ä¸ºæŒ‡å®šç‰ˆæœ¬ã€‚

ä¾‹å¦‚ï¼Œè¦ä¸‹è½½ Linux ä¸Šçš„ç‰ˆæœ¬ v1.20.0ï¼Œè¾“å…¥ï¼š
```sh
curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.20.0/bin/linux/amd64/kubectl
```

2. æ ‡è®° kubectl æ–‡ä»¶ä¸ºå¯æ‰§è¡Œï¼š
```sh
chmod +x ./kubectl
```
3. å°†æ–‡ä»¶æ”¾åˆ° PATH è·¯å¾„ä¸‹ï¼š

```sh
sudo mv ./kubectl /usr/local/bin/kubectl
```
4. æµ‹è¯•ä½ æ‰€å®‰è£…çš„ç‰ˆæœ¬æ˜¯æœ€æ–°çš„ï¼š

```sh
kubectl version --client
```

è¾“å‡ºä»¥ä¸‹å†…å®¹è¡¨ç¤ºå®‰è£… `kubectl`æˆåŠŸï¼š
> Client Version: version.Info{Major:"1", Minor:"20", GitVersion:"v1.20.0", GitCommit:"af46c47ce925f4c4ad5cc8d1fca46c7b77d13b38", GitTreeState:"clean", BuildDate:"2020-12-08T17:59:43Z", GoVersion:"go1.15.5", Compiler:"gc", Platform:"linux/amd64"}

### é€šè¿‡kubectlå‘½ä»¤è·å–èŠ‚ç‚¹`node`

è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼š
```sh
kubectl get nodes
```


## Minikube å®‰è£…

å‚è€ƒï¼š 

[minikubeå®‰è£…]()https://www.oschina.net/p/minikube?hmsr=aladdin1e1

[kubectlå®‰è£…]https://kubernetes.io/zh/docs/tasks/tools/install-kubectl/

[Minikube - Kubernetesæœ¬åœ°å®éªŒç¯å¢ƒ](https://developer.aliyun.com/article/221687)

[è§†é¢‘ï¼šk8s-in-actionã€‘Ubuntuå®‰è£…Minikube](https://www.bilibili.com/video/BV1FA41147VW/?spm_id_from=333.788.videocard.0)

[k8sé›†ç¾¤éƒ¨ç½²](https://blog.csdn.net/qq_25490573/article/details/104921123)