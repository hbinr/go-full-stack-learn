<div data-v-57aa6d27="" data-v-65061ebc="" class="article-main" albuminfo="[object Object]" data-v-3b8a9e36=""><h1 data-v-57aa6d27="">Go 会接替 Java，成为下一个企业级编程语言吗？</h1> <div data-v-57aa6d27="" class="sub-title"></div> <div data-v-57aa6d27="" class="article-detail"><ul data-v-57aa6d27="" class="author"><li data-v-57aa6d27=""><a data-v-311bce47="" data-v-90ad1778="" data-v-57aa6d27="" class="com-author-name" target="_blank">Kevin Goslar</a></li></ul> <div data-v-57aa6d27="" class="divider"></div> <ul data-v-57aa6d27="" class="translate"><li data-v-57aa6d27=""><a data-v-311bce47="" data-v-90ad1778="" data-v-57aa6d27="" class="com-author-name" target="_blank">Sambodhi</a></li></ul> <!----></div> <!----> <!----> <div data-v-57aa6d27="" class="article-detail"><p data-v-57aa6d27="" class="detail"><span data-v-57aa6d27="" class="date">发布于：2019 年 4 月 18 日 08:00</span></p></div> <!----> <div data-v-57aa6d27="" class="article-cover"><img data-v-57aa6d27="" src="https://static001.infoq.cn/resource/image/04/53/04d0673dee226b32ef5d2421ee82a753.jpg" alt="Go会接替Java，成为下一个企业级编程语言吗？"></div> <div data-v-57aa6d27="" class="article-typo article-content"><blockquote>
<p>本文最初发布于 HACKERNOON 博客，经原作者 Kevin Goslar 授权由 InfoQ 中文站翻译并分享。</p>
<p>Go 是 Google 开发的一种编程语言，在过去的几年里取得了很大的成功。现代的云端、网络和 DevOps 软件的很大一部分都是用 Go 编写的，例如 Docker、Kubernetes、Terraform、etcd、Istio 等项目。许多公司也将它用于通用场景下的开发工作。藉由 Go 所支持的功能，这些项目得以吸引大量用户，而 Go 的易用性也让越来越多人都能迅速成为贡献者。</p>
<p>Go 的优势在于能够将简单的和经过验证的想法结合起来，同时避免了其他语言中出现的许多问题。本文概述了 Go 背后的一些设计原则和工程智慧，作者认为，Go 语言具备的所有这些优点，将共同推动其成为接替 Java 并主导下一代大型软件开发平台的最有力的编程语言候选。很多优秀的编程语言只是在个别领域比较强大，如果将所有因素都纳入考虑，没有其他语言能够像 Go 语言一样“全面开花”，在大型软件工程方面，尤为如此。</p>
</blockquote><h2>基于现实经验</h2><p>Go 是由经验丰富的软件行业老手一手创建的，长期以来，他们对现有语言的各种缺点有过切身体会的痛苦经历。几十年前，Rob Pike 和 Ken Thompson 在 Unix、C 和 Unicode 的发明中起到了重要作用。Robert Griensemer 在为 JavaScript 和 Java 开发 V8 和 HotSpot 虚拟机之后，在编译器和垃圾收集方面拥有数十年的经验。有太多次，他们不得不等待 Google 规模的 C++/Java 代码库进行编译。于是，他们开始着手创建新的编程语言，将他们半个世纪以来的编写代码所学到的一切经验包含进去。</p><!-- [[[read_end]]] --><h2>专注于大型工程</h2><p>小型工程项目几乎可以用任何编程语言来成功构建。当成千上万的开发人员在数十年的持续时间压力下，在包含数千万行代码的大型代码库上进行协作时，就会发生真正令人痛苦的问题。这样会导致一些问题，如下：</p><ul>
<li>
<p>较长的编译时间导致中断开发。</p>
</li>
<li>
<p>代码库由几个人 / 团队 / 部门 / 公司所拥有，混合了不同的编程风格。</p>
</li>
<li>
<p>公司雇佣了数千名工程师、架构师、测试人员、运营专家、审计员、实习生等，他们需要了解代码库，但也具备广泛的编码经验。</p>
</li>
<li>
<p>依赖于许多外部库或运行时，其中一些不再以原始形式存在。</p>
</li>
<li>
<p>在代码库的生命周期中，每行代码平均被重写 10 次，被弄得千疮百痍，而且还会发生技术偏差。</p>
</li>
<li>
<p>文档不完整。</p>
</li>
</ul><p>Go 注重减轻这些大型工程的难题，有时会以使小型工程变得更麻烦为代价，例如，代码中到处都需要几行额外的代码行。</p><h2>注重可维护性</h2><p>Go 强调尽可能多地将工作转给自动化的代码维护工具中。Go 工具链提供了最常用的功能，如格式化代码和导入、查找符号的定义和用法、简单的重构以及代码异味的识别。由于标准化的代码格式和单一的惯用方式，机器生成的代码更改看起来非常接近 Go 中人为生成的更改并使用类似的模式，从而允许人机之间更加无缝地协作。</p><h2>保持简单明了</h2><blockquote>
<p>初级程序员为简单的问题创建简单的解决方案。高级程序员为复杂的问题创建复杂的解决方案。伟大的程序员找到复杂问题的简单解决方案。</p>
<p>——Charles Connell</p>
</blockquote><p>让很多人惊讶的一点是，Go 居然不包含他们喜欢的其他语言的概念。Go 确实是一种非常小巧而简单的语言，只包含正交和经过验证的概念的最小选择。这鼓励开发人员用最少的认知开销来编写尽可能简单的代码，以便许多其他人可以理解并使用它。</p><h2>使事情清晰明了</h2><blockquote>
<p>良好的代码总是显而易见的，避免了那些小聪明、难以理解的语言特性、诡异的控制流和兜圈子。</p>
</blockquote><p>许多语言都致力提高编写代码的效率。然而，在其生命周期中，人们阅读代码的时间却远远超过最初编写代码所需的时间（100 倍）。例如，审查、理解、调试、更改、重构或重用代码。在查看代码时，往往只能看到并理解其中的一小部分，通常不会有完整的代码库概述。为了解释这一点，Go 将所有内容都明确出来。</p><p>错误处理就是一个例子。让异常在各个点中断代码并在调用链上冒泡会更容易。Go 需要手动处理和返回每个错误。这使得它可以准确地显示代码可以被中断的位置以及如何处理或包装错误。总的来说，这使得错误处理编写起来更加繁琐，但是也更容易理解。</p><h2>简单易学</h2><p>Go 是如此的小巧而简单，以至于人们可以在短短几天内就能研究通整个语言及其基本概念。根据我们的经验，培训用不了一个星期（相比于掌握其他语言需要几个月），初学者就能够理解 Go 专家编写的代码，并为之做出贡献。为了方便吸引更多的用户，Go 网站提供了所有必要的教程和深入研究的文章。这些教程在浏览器中运行，允许人们在将 Go 安装到本地计算机上之前就能够学习和使用 Go。</p><h2>解决之道</h2><blockquote>
<p>Go 强调的是团队之间的合作，而不是个人的自我表达。</p>
</blockquote><p>在 Go（和 Python）中，所有的语言特性都是相互正交和互补的，通常有一种方法可以做一些事情。如果你想让 10 个 Python 或 Go 程序员来解决同一个问题，你将会得到 10 个相对类似的解决方案。不同的程序员在彼此的代码库中感觉更自在。在查看其他人的代码时，国骂会更少，而且人们的工作可以更好地融合在一起，从而形成了一致的整体，人人都为之感到自豪，并乐于工作。这还避免了大型工程的问题，如：</p><ul>
<li>
<p>开发人员认为良好的工作代码很“混乱”，并要求在开始工作之前进行重写，因为他们的思维方式与原作者不同。</p>
</li>
<li>
<p>不同的团队成员使用不同的语言子集来编写相同代码库的部分内容。</p>
</li>
</ul><p><img src="https://static.geekbang.org/infoq/5cb6ecdea8dd9.png" alt="Go会接替Java，成为下一个企业级编程语言吗？"></p><center>图片来源：https://www.osnews.com/story/19266/wtfsm</center><h2>简单、内置的并发性</h2><blockquote>
<p>Go 专为现代多核硬件设计。</p>
</blockquote><p>目前使用的大多数编程语言（Java、JavaScript、Python、Ruby、C、C++）都是 20 世纪 80 年代到 21 世纪初设计的，当时大多数 CPU 只有一个计算内核。这就是为什么它们本质上是单线程的，并将并行化视为边缘情况的马后炮。通过现成和同步点之类的附加组件来实现，而这些附加组件既麻烦又难以正确使用。第三方库虽然提供了更简单的并发形式，如 Actor 模型，但是总有多个可用选项，结果导致了语言生态系统的碎片化。今天的硬件拥有越来越多的计算内核，软件必须并行化才能高效运行。Go 是在多核处理器时代编写的，并且在语言中内置了简单、高级的 CSP 风格并发性。</p><h2>面向计算的语言原语</h2><p>就深层而言，计算机系统接收数据，对其进行处理（通常要经过几个步骤），然后输出结果数据。例如，Web 服务器从客户端接收 HTTP 请求，并将其转换为一系列数据库或后端调用。一旦这些调用返回，它就将接收到的数据转换成 HTML 或 JSON 并将其输出给调用者。Go 的内置语言原语直接支持这种范例：</p><ul>
<li>
<p>结构表示数据</p>
</li>
<li>
<p>读和写代表流式 IO</p>
</li>
<li>
<p>函数过程数据</p>
</li>
<li>
<p>goroutines 提供（几乎无限的）并发性</p>
</li>
<li>
<p>在并行处理步骤之间传输管道数据</p>
</li>
</ul><p>因为所有的计算原语都是由语言以直接形式提供的，因此 Go 源代码更直接地表达了服务器执行的操作。</p><h2>OO&#8202;—&#8202;好的部分</h2><p><img src="https://static.geekbang.org/infoq/5cb6ece07d526.png" alt="Go会接替Java，成为下一个企业级编程语言吗？"></p><p>更改基类中的某些内容的副作用</p><p>面向对象非常有用。过去几十年来，面向对象的使用富有成效，并让我们了解了它的哪些部分比其他部分能够更好地扩展。Go 在面向对象方面采用了一种全新的方法，并记住了这些知识。它保留了好的部分，如封装、消息传递等。Go 还避免了继承，因为它现在被认为是有害的，并为组合提供了一流的支持。</p><h2>现代标准库</h2><p>目前使用的许多编程语言（Java、JavaScript、Python、Ruby）都是在互联网成为当今无处不在的计算平台之前设计的。因此，这些语言的标准库只提供了相对通用的网络支持，而这些网络并没有针对现代互联网进行优化。Go 是十年前创建的，当时互联网已全面发展。Go 的标准库允许在没有第三方库的情况下创建更复杂的网络服务。这就避免了第三方库的常见问题：</p><ul>
<li>
<p><strong>碎片化：</strong>总是有多个选项实现相同的功能。</p>
</li>
<li>
<p><strong>膨胀：</strong>库常常实现的不仅仅是它们的用途。</p>
</li>
<li>
<p><strong>依赖地狱：</strong>库通常依赖于特定版本的其他库。</p>
</li>
<li>
<p><strong>未知质量：</strong>第三方代码的质量和安全性可能存在问题。</p>
</li>
<li>
<p><strong>未知支持：</strong>第三方库的开发可能随时停止支持。</p>
</li>
<li>
<p><strong>意外更改：</strong>第三方库通常不像标准库那样严格地进行版本控制。</p>
</li>
</ul><p>关于这方面更多的信息请参考 Russ Cox 提供的资料：<a href="https://research.swtch.com/deps" rel="noopener nofollow" target="_blank"> https://research.swtch.com/deps </a></p><h2>标准化格式</h2><blockquote>
<p>Gofmt 的风格没有人会去喜欢，但人人都会喜欢 gofmt。<br>
——Rob Pike</p>
</blockquote><p>Gofmt 是一种以标准化方式来格式化 Go 代码的程序。它不是最漂亮的格式化方式，但却是最简单、最不令人生厌的格式化方式。标准化的源代码格式具有惊人的积极影响：</p><ol>
<li>
<p><strong>集中讨论重要主题：</strong> 它消除了围绕制表符和空格、缩进深度、行长、空行、花括号的位置等一系列争论。</p>
</li>
<li>
<p><strong>开发人员在彼此的代码库中感觉很自在，</strong> 因为其他代码看起来很像他们编写的代码。每个人都喜欢自由地按照自己喜欢的方式进行格式化代码，但如果其他人按照自己喜欢的方式格式化了代码，这么做很招人烦。</p>
</li>
<li>
<p><strong>自动代码更改</strong>并不会打乱手写代码的格式，例如引入了意外的空白更改。</p>
</li>
</ol><p>许多其他语言社区现在正在开发类似 gofmt 的东西。当作为第三方解决方案构建时，通常会有几个相互竞争的格式标准。例如，JavaScript 提供了 Prettier 和 StandardJS。这两者都可以用，也可以只使用其中的一个。但许多 JS 项目并没有采用它们，因为这是一个额外的决策。Go 的格式化程序内置于该语言的标准工具链中，因此只有一个标准，每个人都在使用它。</p><h2>快速编译</h2><p><img src="https://static.geekbang.org/infoq/5cb6ecdf59af8.png" alt="Go会接替Java，成为下一个企业级编程语言吗？"></p><center>图片来源：https://xkcd.com/303</center><p>对于大型代码库来说，它们长时间的编译是促使 Go 诞生的原因。Google 主要使用的是 C++ 和 Java，与 Haskell、Scala 或 Rust 等更复杂的语言相比，它们的编译速度相对较快。尽管如此，当编译大型代码库时，即使是少量的缓慢也会加剧编译的延迟，从而激怒开发人员，并干扰流程。Go 的设计初衷是为了提高编译效率，因此它的编译器速度非常快，几乎没有编译延迟的现象。这给 Go 开发人员提供了与脚本类语言类似的即时反馈，还有静态类型检查的额外好处。</p><h2>交叉编译</h2><p>由于语言运行时非常简单，因此它被移植到许多平台，如 macOS、Linux、Windows、BSD、ARM 等。Go 可以开箱即用地为所有这些平台编译二进制文件。这使得从一台机器进行部署变得很容易。</p><h2>快速执行</h2><p>Go 的运行速度接近于 C。与 JITed 语言（Java、JavaScript、Python 等）不同，Go 二进制文件不需要启动或预热的时间，因为它们是作为编译和完全优化的本地代码的形式发布的。Go 的垃圾收集器仅引入微秒量级的可忽略的停顿。除了快速的单核性能外，Go 还可以轻松利用所有的 CPU 内核。</p><h2>内存占用小</h2><p>像 JVM、Python 或 Node 这样的运行时不仅仅在运行时加载程序代码，每次运行程序时，它们还会加载大型且高度复杂的基础架构，以进行编译和优化程序。如此一来，它们的启动时间就变慢了，并且还占用了大量内存（数百兆字节）。而 Go 进程的开销更小，因为它们已经完全编译和优化，只需运行即可。Go 还以非常节省内存的方式来存储数据。在内存有限且昂贵的云环境中，以及在开发过程中，这一点非常重要。我们希望在一台机器上能够快速启动整个堆栈，同时将内存留给其他软件。</p><h2>部署规模小</h2><p>Go 的二进制文件大小非常简洁。Go 应用程序的 Docker 镜像通常比用 Java 或 Node 编写的等效镜像要小 10 倍，这是因为它无需包含编译器、JIT，以及更少的运行时基础架构的原因。这些特点，在部署大型应用程序时很重要。想象一下，如果要将一个简单的应用程序部署到 100 个生产服务器上会怎么样？如果使用 Node/JVM 时，我们的 Docker 注册表就必须提供 100 个 docker 镜像，每个镜像 200MB，那么一共就需要 20GB。要完成这些部署就需要一些时间。想象一下，如果我们想每天部署 100 次的话，如果使用 Go 服务，那么 Docker 注册表只需提供 10 个 docker 镜像，每个镜像只有 20MB，共只需 2GB 即可。大型 Go 应用程序可以更快、更频繁地部署，从而使得重要更新能够更快地部署到生产环境中。</p><h2>独立部署</h2><p>Go 应用程序部署为一个包含所有依赖项的单个可执行文件，并无需安装特定版本的 JVM、Node 或 Python 运行时；也不必将库下载到生产服务器上，更无须对运行 Go 二进制文件的机器进行任何更改。甚至也不需要讲 Go 二进制文件包装到 Docker 来共享他们。你需要做的是，只是将 Go 二进制文件放到服务器上，它就会在那里运行，而不用关心服务器运行的是什么。前面所提到的那些，唯一的例外是使用<code>net</code>和<code>os/user</code>包时针对对<code>glibc</code>的动态链接。</p><h2>供应依赖关系</h2><p>Go 有意识避免使用第三方库的中央存储库。Go 应用程序直接链接到相应的 Git 存储库，并将所有相关代码下载（供应）到自己的代码库中。这样做有很多好处：</p><ul>
<li>
<p>在使用第三方代码之前，我们可以对其进行审查、分析和测试。该代码就和我们自己的代码一样，是我们应用程序的一部分，应该遵循相同的质量、安全性和可靠性标准。</p>
</li>
<li>
<p>无需永久访问存储依赖项的各个位置。从任何地方（包括私有 Git repos）获取第三方库，你就能永久拥有它们。</p>
</li>
<li>
<p>经过验收后，编译代码库无需进一步下载依赖项。</p>
</li>
<li>
<p>若互联网某处的代码存储库突然提供不同的代码，这也并不足为奇。</p>
</li>
<li>
<p>即使软件包存储库速度变慢，或托管包不复存在，部署也不会因此中断。</p>
</li>
</ul><h2>兼容性保证</h2><p>Go 团队承诺现有的程序将会继续适用于新一代语言。这使得将大型项目升级到最新版本的编译器会非常容易，并且可从它们带来的许多性能和安全性改进中获益。同时，由于 Go 二进制文件包含了它们需要的所有依赖项，因此可以在同一服务器上并行运行使用不同版本的 Go 编译器编译的二进制文件，而无需进行复杂的多个版本的运行时设置或虚拟化。</p><h2>文档</h2><p>在大型工程中，文档对于使软件可访问性和可维护性非常重要。与其他特性类似，Go 中的文档简单实用：</p><ul>
<li>
<p>由于它是嵌入到源代码中的，因此两者可以同时维护。</p>
</li>
<li>
<p>它不需要特殊的语法，文档只是普通的源代码注释。</p>
</li>
<li>
<p>可运行单元测试通常是最好的文档形式。因此 Go 要求将它们嵌入到文档中。</p>
</li>
<li>
<p>所有的文档实用程序都内置在工具链中，因此每个人都使用它们。</p>
</li>
<li>
<p>Go linter 需要导出元素的文档，以防止“文档债务”的积累。</p>
</li>
</ul><h2>商业支持的开源</h2><p>当商业实体在开放式环境下开发时，那么一些最流行的、经过彻底设计的软件就会出现。这种设置结合了商业软件开发的优势——一致性和精细化，使系统更为健壮、可靠、高效，并具有开放式开发的优势，如来自许多行业的广泛支持，多个大型实体和许多用户的支持，以及即使商业支持停止的长期支持。Go 就是这样发展起来的。</p><h2>缺点</h2><p>当然，Go 也并非完美无缺，每种技术选择都是有利有弊。在决定选择 Go 之前，有几个方面需要进行考虑考虑。</p><h3>未成熟</h3><p>虽然 Go 的标准库在支持许多新概念（如 HTTP 2 Server push 等）方面处于行业领先地位，但与 JVM 生态系统中的第三方库相比，用于外部 API 的第三方 Go 库可能不那么成熟。</p><h3>即将到来的改进</h3><p>由于清楚几乎不可能改变现有的语言元素，Go 团队非常谨慎，只在新特性完全开发出来后才添加新特性。在经历了 10 年的有意稳定阶段之后，Go 团队正在谋划对语言进行一系列更大的改进，作为 Go 2.0 之旅的一部分。</p><h3>无硬实时</h3><p>虽然 Go 的垃圾收集器只引入了非常短暂的停顿，但支持硬实时需要没有垃圾收集的技术，例如 Rust。</p><h2>结语</h2><p>本文详细介绍了 Go 语言的一些优秀的设计准则，虽然有的准则的好处平常看起来没有那么明显。但当代码库和团队规模增长几个数量级时，这些准则可能会使大型工程项目免于许多痛苦。总的来说，正是这些设计准则让 Go 语言成为了除 Java 之外的编程语言里，用于大型软件开发项目的绝佳选择。</p><p>原文链接：</p><p><a href="https://hackernoon.com/go-is-on-a-trajectory-to-become-the-next-enterprise-programming-language-3b75d70544e" rel="noopener nofollow" target="_blank"> https://hackernoon.com/go-is-on-a-trajectory-to-become-the-next-enterprise-programming-language-3b75d70544e </a></p></div> <!----></div>